library(readr)
twitter_data <- read_csv("datasets/twitter_data.csv")
View(twitter_data)
knitr::opts_chunk$set(echo = TRUE)
library(stringr)
library(jsonlite)
library(dplyr)
# 1. Lire le fichier brut
lines <- readLines("datasets/twitter_data.csv")
# 2. Fonction pour parser une ligne
parse_line <- function(line) {
# Cherche : valeurs entre guillemets, blocs entre crochets, ou champs simples
matches <- str_match_all(line, '"[^"]*"|\\[.*?\\]|[^,]+')[[1]][, 1]
# Retirer les guillemets autour des champs texte
matches <- gsub('^"(.*)"$', "\\1", matches)
return(matches)
}
# 3. Appliquer à toutes les lignes
parsed_list <- lapply(lines, parse_line)
# 4. Vérifier que toutes les lignes ont le même nombre de colonnes
col_counts <- sapply(parsed_list, length)
if (length(unique(col_counts)) != 1) {
stop("Certaines lignes n'ont pas le même nombre de colonnes !")
}
# 5. Construire le data frame
twitter_data <- as.data.frame(do.call(rbind, parsed_list), stringsAsFactors = FALSE)
# 6. Renommer les colonnes (à adapter à ton CSV exact)
colnames(twitter_data) <- c(
"id", "screenName", "tags", "avatar", "followersCount",
"friendsCount", "lang", "lastSeen", "tweetId", "friends"
)
# 7. Forcer les colonnes JSON à être character
twitter_data$tags <- as.character(twitter_data$tags)
twitter_data$friends <- as.character(twitter_data$friends)
# 8. Parsing JSON sécurisé
safe_fromJSON <- function(x) {
if (is.na(x) || x == "" || !grepl("^\\[", x)) return(NA)
tryCatch(fromJSON(x), error = function(e) NA)
}
twitter_data$tags <- lapply(twitter_data$tags, safe_fromJSON)
twitter_data$friends <- lapply(twitter_data$friends, safe_fromJSON)
twitter_data <- twitter_data[-1, ]
data <- twitter_data%>%
mutate(followersCount=as.integer(followersCount),friendsCount=as.integer(friendsCount))
twitter_data<-data%>%select(id,followersCount,friendsCount)
set.seed(123)
n <- nrow(df)
train_indices <- sample(1:n, size = 0.75 * n)
set.seed(123)
n <- nrow(data)
train_indices <- sample(1:n, size = 0.75 * n)
# Séparation des données
train_data <- df[train_indices, ]
set.seed(123)
n <- nrow(data)
train_indices <- sample(1:n, size = 0.75 * n)
# Séparation des données
train_data <- data[train_indices, ]
test_data  <- data[-train_indices, ]
# Vérification
nrow(train_data)
nrow(test_data)
summaty(data)
summary(data)
head(data,2)
r<-lm(followersCount~friendsCount,train_data)
r<-lm(followersCount~friendsCount,train_data)
summary(r)
plot(r)
